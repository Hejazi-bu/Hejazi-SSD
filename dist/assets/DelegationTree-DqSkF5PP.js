import{r as h,k as e,ap as $,av as k,A as D,m as R,aw as y,ar as w,v as P}from"./index-AlbxRJrk.js";import{F as C}from"./ChevronDownIcon-BtYLWBft.js";import{F as E}from"./ChevronRightIcon-CG6pqeHi.js";import{F as A}from"./CogIcon-Cm0Oc8sb.js";import{F as z}from"./PencilIcon-DZheH_sc.js";const S=h.memo(({currentState:r,jobState:x,onChange:t,disabled:o,type:n="user"})=>{if(o)return e.jsx("div",{className:"opacity-30 cursor-not-allowed p-2",children:e.jsx(y,{className:"w-6 h-6 text-gray-500"})});const d=s=>{s.preventDefault(),s.stopPropagation()};if(n==="job"||n==="company"){const s=r===!0;return e.jsxs("div",{className:"flex items-center bg-gray-900/80 rounded-lg p-1 border border-gray-700 shrink-0 z-10 relative gap-1 shadow-sm",onClick:d,children:[e.jsx("button",{onClick:c=>{c.stopPropagation(),t(void 0)},className:`w-7 h-7 flex items-center justify-center rounded transition-all ${s?"text-gray-500 hover:bg-gray-800":"bg-red-500/20 text-red-400 border border-red-500/50"}`,title:"سحب الصلاحية",children:e.jsx(y,{className:"w-5 h-5"})}),e.jsx("button",{onClick:c=>{c.stopPropagation(),t(!0)},className:`w-7 h-7 flex items-center justify-center rounded transition-all ${s?"bg-[#FFD700]/20 text-[#FFD700] border border-[#FFD700]/50":"text-gray-500 hover:bg-gray-800"}`,title:"منح الصلاحية",children:e.jsx(w,{className:"w-5 h-5"})})]})}return e.jsxs("div",{className:"flex items-center bg-gray-900/80 rounded-lg p-1 border border-gray-700 shrink-0 z-10 relative gap-1 shadow-sm",onClick:d,children:[e.jsx("button",{onClick:s=>{s.stopPropagation(),t(!1)},className:`w-7 h-7 flex items-center justify-center rounded transition-all ${r===!1?"bg-red-500/20 text-red-400 border border-red-500/50":"text-gray-500 hover:bg-gray-800"}`,title:"حظر",children:e.jsx(y,{className:"w-5 h-5"})}),e.jsxs("button",{onClick:s=>{s.stopPropagation(),t(void 0)},className:`w-7 h-7 flex items-center justify-center rounded transition-all relative ${r===void 0?"bg-blue-500/20 text-blue-400 border border-blue-500/50":"text-gray-500 hover:bg-gray-800"}`,title:"توريث من الوظيفة",children:[e.jsx(P,{className:"w-4 h-4"}),r===void 0&&e.jsx("span",{className:`absolute top-1 right-1 w-1.5 h-1.5 rounded-full ${x?"bg-green-500":"bg-gray-600"}`})]}),e.jsx("button",{onClick:s=>{s.stopPropagation(),t(!0)},className:`w-7 h-7 flex items-center justify-center rounded transition-all ${r===!0?"bg-[#FFD700]/20 text-[#FFD700] border border-[#FFD700]/50":"text-gray-500 hover:bg-gray-800"}`,title:"منح استثناء",children:e.jsx(w,{className:"w-5 h-5"})})]})}),G=h.memo(({node:r,getState:x,getJobState:t,getInitialState:o,onToggle:n,canEdit:d,t:s,depth:c=0,searchTerm:f="",rowType:b="user",renderScopeButton:p})=>{const[m,u]=h.useState(!1),a=r.type==="service",g=r.type==="page";h.useEffect(()=>{f.length>0?u(!0):a&&u(!1)},[f,a]);const l=x(r.id),F=t?t(r.id):!1,v=o?o(r.id):void 0,N=(l!==void 0||v!==void 0)&&l!==v,j=r.children&&r.children.length>0;return d(r.id)?e.jsxs("div",{className:"flex flex-col w-full mb-1",children:[e.jsxs("div",{className:`
                    relative flex items-center justify-between p-3 rounded-lg border transition-all w-full cursor-pointer group
                    ${a?"bg-gray-800/80 border-gray-700 shadow-sm":g?"bg-gray-800/40 border-gray-700/50":"bg-gray-900/40 border-gray-800"}
                    hover:border-[#FFD700]/30 hover:bg-gray-800/60
                `,onClick:()=>j&&u(!m),children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 overflow-hidden",children:[e.jsx("div",{className:`w-6 h-6 flex items-center justify-center text-gray-500 transition-transform ${m?"rotate-0":"rtl:rotate-180"}`,children:j&&(m?e.jsx(C,{className:"w-4 h-4 text-[#FFD700]"}):e.jsx(E,{className:"w-4 h-4"}))}),e.jsx("div",{className:`shrink-0 ${a?"text-[#FFD700]":g?"text-blue-400":"text-green-400"}`,children:a?e.jsx($,{className:"w-5 h-5"}):g?e.jsx(k,{className:"w-5 h-5"}):e.jsx(A,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("span",{className:`text-sm font-bold truncate ${l===!0?"text-[#FFD700]":l===!1||l===void 0&&b==="job"?"text-gray-400":"text-gray-300"}`,children:r.label}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[e.jsx("span",{className:"text-[10px] text-gray-500",children:a?s.levelService:g?s.levelPage:s.levelAction}),N&&e.jsx("span",{className:"text-blue-400 text-[10px] flex items-center gap-1 bg-blue-500/10 px-1 rounded",children:e.jsx(z,{className:"w-3 h-3"})})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",onClick:i=>i.stopPropagation(),children:[p&&p(r),e.jsx(S,{currentState:l,jobState:F,onChange:i=>n(r.id,i),disabled:!1,type:b})]})]}),e.jsx(D,{children:m&&j&&e.jsx(R.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"flex flex-col w-full pl-4 rtl:pr-4 mt-1 border-l-2 border-gray-800/50 ml-3 rtl:mr-3 rtl:border-l-0 rtl:border-r-2",children:r.children.map(i=>e.jsx(G,{node:i,getState:x,getJobState:t,getInitialState:o,onToggle:n,canEdit:d,t:s,depth:c+1,searchTerm:f,rowType:b,renderScopeButton:p},i.id))})})]}):null});export{G as S};
