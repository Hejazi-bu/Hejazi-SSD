import{u as ye,a as xe,b as De,c as Re,d as Me,e as Ae,f as $e,r as m,g as re,q as oe,o as he,h as se,i as le,w as ze,aG as Le,k as e,A as W,m as N,l as Ie,j,p as be,C as Oe,D as qe,E as Je,s as Ue,x as Q,as as O,aU as Ve,v as He,aJ as We,aV as Ge,aW as _e,aX as ae,aY as Ze,J as Ke,ar as Ye,aw as ne,n as te,z as ue,B as ge,y as fe,aZ as ve,H as we,a_ as Be}from"./index-AlbxRJrk.js";const B=t=>{if(!t)return"";let r=t.replace(/\D/g,"");for(r.startsWith("0")&&(r=r.substring(1)),r.startsWith("971")&&(r=r.substring(3));r.startsWith("0");)r=r.substring(1);return r},de=()=>({toFirestore:t=>t,fromFirestore:(t,r)=>({id:t.id,...t.data(r)})}),Xe=de(),Qe=de(),ea=de();function k({label:t,name:r,value:E,onChange:q,placeholder:f,language:A,error:g,fieldRef:F,type:w="text",children:l=null,icon:o,maxLength:T,pattern:D,disabled:a=!1,inputMode:C}){const v=w==="textarea"?"textarea":w==="select"?"select":"input",y=m.useMemo(()=>["email","name_en","phone_number","employee_id","work_email","work_phone","company_email","company_phone","company_landline_phone","landline_phone","alternative-phone","first_name_en","second_name_en","third_name_en","last_name_en"].includes(r)?"ltr":"rtl",[r]);return e.jsxs(N.div,{ref:F,className:`p-4 rounded-lg shadow-md border ${g?"border-red-500":a?"bg-gray-700/30 border-gray-700":"bg-gray-900/50 border-gray-700"}`,variants:{...te,...fe},whileHover:"hover",animate:g?"animate":"initial",children:[e.jsxs("label",{htmlFor:r,className:`flex items-center mb-2 font-semibold ${a?"text-gray-400":"text-gray-200"}`,children:[e.jsx(o,{className:"w-5 h-5 me-2 text-[#FFD700]"}),t]}),e.jsx(v,{id:r,name:r,value:E,onChange:q,placeholder:f||"...",type:w==="select"||w==="textarea"?void 0:w,className:`w-full p-2.5 rounded-md border border-gray-600 focus:outline-none focus:ring-2 focus:ring-[#FFD700] ${a?"bg-gray-600/50 cursor-not-allowed":"bg-gray-700"}
                ${r==="employee_id"||r==="landline_phone"?"remove-arrow":""}`,dir:y,rows:w==="textarea"?3:void 0,maxLength:T,pattern:D,disabled:a,inputMode:C,children:l}),g&&e.jsxs(N.p,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},className:"mt-2 text-sm text-red-400 flex items-center",children:[e.jsx(ne,{className:"w-4 h-4 me-1 flex-shrink-0"}),g]}),e.jsx("style",{children:`
                .remove-arrow::-webkit-outer-spin-button,
                .remove-arrow::-webkit-inner-spin-button {
                    -webkit-appearance: none;
                    margin: 0;
                }
                .remove-arrow {
                    -moz-appearance: textfield;
                }
            `})]})}function aa({label:t,name:r,value:E,onChange:q,error:f,fieldRef:A,language:g,allCountries:F}){const[w,l]=m.useState(!1),[o,T]=m.useState(""),D=m.useRef(null),a=m.useRef(null),C=g==="ar",v=(F||[]).find(h=>h.id===E),y=m.useMemo(()=>{const h=j(o).toLowerCase();return h?F.filter(z=>{const V=j(z.name_ar).toLowerCase().includes(h),i=j(z.name_en).toLowerCase().includes(h);return V||i}):F},[F,o]),s=h=>{q({target:{value:h,name:r}}),l(!1),T("")};return m.useEffect(()=>{const h=z=>{D.current&&!D.current.contains(z.target)&&l(!1)};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[]),m.useEffect(()=>{w&&a.current&&a.current.focus()},[w]),e.jsxs(N.div,{ref:A,className:`p-4 rounded-lg shadow-md border ${f?"border-red-500":"bg-gray-900/50 border-gray-700"}`,variants:{...te,...fe},whileHover:"hover",animate:f?"animate":"initial",children:[e.jsxs("label",{htmlFor:r,className:"flex items-center mb-2 font-semibold text-gray-200",children:[e.jsx(Be,{className:"w-5 h-5 me-2 text-[#FFD700]"}),t]}),e.jsxs("div",{className:"relative",ref:D,children:[e.jsxs("button",{type:"button",onClick:()=>l(h=>!h),className:"w-full flex items-center justify-between p-2.5 bg-gray-700 border border-gray-600 focus:outline-none focus:ring-2 focus:ring-[#FFD700] rounded-md text-left text-gray-200",style:{minHeight:"40px"},children:[e.jsxs("span",{className:"flex items-center",children:[E&&v?.flag_emoji&&e.jsxs("span",{className:"mr-2",children:[v.flag_emoji,"Â Â "]}),E?g==="ar"?v?.name_ar:v?.name_en:g==="ar"?"Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù†Ø³ÙŠØ©...":"Select Nationality..."]}),e.jsx(ve,{className:"w-4 h-4"})]}),e.jsx(W,{children:w&&e.jsxs(N.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:`absolute z-20 w-full max-h-80 overflow-y-auto bg-gray-800 border border-gray-700 rounded-lg shadow-lg mt-1 ${C?"right-0":"left-0"}`,children:[e.jsx("div",{className:"p-2 border-b border-gray-700 sticky top-0 bg-gray-800",children:e.jsxs("div",{className:"relative",children:[e.jsx(we,{className:`absolute ${C?"right-3":"left-3"} top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400`}),e.jsx("input",{ref:a,type:"text",placeholder:g==="ar"?"Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù…...":"Search name...",value:o,onChange:h=>T(h.target.value),className:`w-full py-2 bg-gray-700 rounded-md text-sm text-gray-200 focus:outline-none ${C?"pr-10 pl-3":"pl-10 pr-3"}`,dir:g==="ar"?"rtl":"ltr"})]})}),(y.length>0?y:F).map(h=>e.jsxs("div",{className:"flex items-center p-2 cursor-pointer hover:bg-gray-700 transition duration-150 text-gray-200 text-sm",onClick:()=>s(h.id),children:[e.jsxs("span",{className:"mr-2",children:[h.flag_emoji,"Â Â "]}),e.jsx("span",{className:"flex-grow truncate",dir:g==="ar"?"rtl":"ltr",children:g==="ar"?h.name_ar:h.name_en})]},h.id)),y.length===0&&o&&e.jsx("p",{className:"p-2 text-center text-sm text-gray-400",children:g==="ar"?"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬":"No results found"})]})})]}),f&&e.jsxs(N.p,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},className:"mt-2 text-sm text-red-400 flex items-center",children:[e.jsx(ne,{className:"w-4 h-4 me-1 flex-shrink-0"}),f]})]})}function ee({label:t,name:r,value:E,onChange:q,error:f,fieldRef:A,language:g,allCountries:F,currentCountryId:w,onCodeChange:l,disabled:o=!1}){const[T,D]=m.useState(!1),[a,C]=m.useState(""),v=m.useRef(null),y=m.useRef(null),s=g==="ar",h=(F||[]).find(p=>p.id===w),z=h?.dial_code||(w==="AE"?"+971":"+..."),L=`${w?(p=>p==="AE"?"5":"X")(w):"X"}xxxxxxxx`,H=m.useMemo(()=>{const p=j(a).toLowerCase();return p?F.filter(R=>j(R.name_ar).toLowerCase().includes(p)||j(R.name_en).toLowerCase().includes(p)||j(R.dial_code).toLowerCase().includes(p)):F},[F,a]),X=p=>{l(p.id),D(!1),C("")};return m.useEffect(()=>{const p=R=>{v.current&&!v.current.contains(R.target)&&D(!1)};return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[]),m.useEffect(()=>{T&&y.current&&y.current.focus()},[T]),e.jsxs(N.div,{variants:te,whileHover:"hover",className:`p-4 rounded-lg shadow-md border ${f?"border-red-500":o?"bg-gray-700/30 border-gray-700":"bg-gray-900/50 border-gray-700"}`,ref:v,children:[e.jsxs("label",{htmlFor:r,className:`flex items-center mb-2 font-semibold ${o?"text-gray-400":"text-gray-200"}`,children:[e.jsx(ae,{className:"w-5 h-5 me-2 text-[#FFD700]"})," ",t]}),e.jsxs("div",{className:"flex w-full relative",dir:"ltr",children:[e.jsxs("button",{type:"button",onClick:()=>{o||D(p=>!p)},className:"flex-shrink-0 flex items-center justify-between p-2.5 border border-gray-600 transition focus:outline-none focus:ring-2 focus:ring-[#FFD700] rounded-l-md text-gray-200 text-sm",style:{width:"150px"},disabled:o,children:[e.jsxs("span",{className:"truncate",children:[h?.flag_emoji||"ðŸŒ"," ",z]}),e.jsx(ve,{className:"w-4 h-4 ml-1"})]}),e.jsx("input",{id:r,name:r,type:"text",inputMode:"numeric",value:E,onChange:q,placeholder:E?"":L,className:`w-full p-2.5 border border-gray-600 border-l-0 focus:outline-none focus:ring-2 focus:ring-[#FFD700] rounded-r-md remove-arrow ${o?"bg-gray-600/50 cursor-not-allowed":"bg-gray-700"}`,dir:"ltr",ref:A,pattern:"\\d+",disabled:o}),e.jsx(W,{children:T&&e.jsxs(N.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:`absolute z-20 w-72 max-h-80 overflow-y-auto bg-gray-800 border border-gray-700 rounded-lg shadow-lg mt-14 ${s?"right-0":"left-0"}`,children:[e.jsx("div",{className:"p-2 border-b border-gray-700 sticky top-0 bg-gray-800",children:e.jsxs("div",{className:"relative",children:[e.jsx(we,{className:`absolute ${s?"right-3":"left-3"} top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400`}),e.jsx("input",{ref:y,type:"text",placeholder:g==="ar"?"Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„ÙƒÙˆØ¯":"Search name or code",value:a,onChange:p=>C(p.target.value),className:`w-full py-2 bg-gray-700 rounded-md text-sm text-gray-200 focus:outline-none ${s?"pr-10 pl-3":"pl-10 pr-3"}`,dir:g==="ar"?"rtl":"ltr"})]})}),(H.length>0?H:F).map(p=>e.jsxs("div",{className:"flex items-center p-2 cursor-pointer hover:bg-gray-700 transition duration-150 text-gray-200 text-sm",onClick:()=>X(p),children:[e.jsxs("span",{className:"mr-2",children:[p.flag_emoji,"Â Â "]}),e.jsx("span",{className:"flex-grow truncate",dir:g==="ar"?"rtl":"ltr",children:g==="ar"?p.name_ar:p.name_en}),e.jsx("span",{className:"ml-2 font-semibold text-gray-400 flex-shrink-0",children:p.dial_code})]},p.id)),H.length===0&&a&&e.jsx("p",{className:"p-2 text-center text-sm text-gray-400",children:g==="ar"?"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬":"No results found"})]})})]}),f&&e.jsxs(N.p,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},className:"mt-2 text-sm text-red-400 flex items-center",children:[e.jsx(ne,{className:"w-4 h-4 me-1 flex-shrink-0"}),f]})]})}function na({formData:t,onFormChange:r,onNameChange:E,allCompanies:q,allJobs:f,allCountries:A,onSubmit:g,isSubmitting:F,translations:w,formRefs:l,formErrors:o,canPerformSaveAction:T,userHasSignature:D,entityPhoneStatus:a,onPhoneStatusChange:C,onCountrySelectChange:v,onPhoneCodeChange:y}){const{language:s}=ye(),{user:h,hasPermission:z,isLoading:V}=xe(),i=w[s].common,L=w[s],H=t.company_id==="1",p=!!t.company_id,R=!H,ie=a==="stopped"&&R;return e.jsxs(N.div,{variants:Ue,initial:"initial",animate:"animate",exit:"exit",className:"flex-grow bg-gray-800/50 rounded-xl shadow-2xl space-y-8 p-4 sm:p-6 border border-gray-700",children:[e.jsxs(N.div,{variants:Q,className:"space-y-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-100 border-b border-gray-700 pb-2",children:[L.personalData," ",e.jsx(O,{className:"inline-block w-6 h-6 text-[#FFD700]"})]}),e.jsxs("div",{dir:"rtl",className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 p-4 border border-gray-700 rounded-lg bg-gray-800/80",children:[e.jsx("h3",{className:"lg:col-span-4 text-lg font-semibold text-gray-200",children:i.arabicName}),e.jsx(k,{label:i.firstName,name:"first_name_ar",value:t.first_name_ar,onChange:E,placeholder:"...",language:s,error:o.first_name_ar,fieldRef:n=>l.current.first_name_ar=n,icon:O,pattern:"[\\u0600-\\u06FF\\s]+"}),e.jsx(k,{label:i.secondName,name:"second_name_ar",value:t.second_name_ar,onChange:E,placeholder:"...",language:s,error:o.second_name_ar,fieldRef:n=>l.current.second_name_ar=n,icon:O,pattern:"[\\u0600-\\u06FF\\s]+"}),e.jsx(k,{label:i.thirdName,name:"third_name_ar",value:t.third_name_ar,onChange:E,placeholder:"...",language:s,error:o.third_name_ar,fieldRef:n=>l.current.third_name_ar=n,icon:O,pattern:"[\\u0600-\\u06FF\\s]+"}),e.jsx(k,{label:i.lastName,name:"last_name_ar",value:t.last_name_ar,onChange:E,placeholder:"...",language:s,error:o.last_name_ar,fieldRef:n=>l.current.last_name_ar=n,icon:O,pattern:"[\\u0600-\\u06FF\\s]+"})]}),e.jsxs("div",{dir:"ltr",className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 p-4 border border-gray-700 rounded-lg bg-gray-800/80",children:[e.jsx("h3",{className:"lg:col-span-4 text-lg font-semibold text-gray-200",children:i.englishName}),e.jsx(k,{label:i.firstName,name:"first_name_en",value:t.first_name_en,onChange:E,placeholder:"...",language:s,error:o.first_name_en,fieldRef:n=>l.current.first_name_en=n,icon:O,pattern:"[a-zA-Z\\s]+"}),e.jsx(k,{label:i.secondName,name:"second_name_en",value:t.second_name_en,onChange:E,placeholder:"...",language:s,error:o.second_name_en,fieldRef:n=>l.current.second_name_en=n,icon:O,pattern:"[a-zA-Z\\s]+"}),e.jsx(k,{label:i.thirdName,name:"third_name_en",value:t.third_name_en,onChange:E,placeholder:"...",language:s,error:o.third_name_en,fieldRef:n=>l.current.third_name_en=n,icon:O,pattern:"[a-zA-Z\\s]+"}),e.jsx(k,{label:i.lastName,name:"last_name_en",value:t.last_name_en,onChange:E,placeholder:"...",language:s,error:o.last_name_en,fieldRef:n=>l.current.last_name_en=n,icon:O,pattern:"[a-zA-Z\\s]+"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx(k,{label:i.personalEmail,name:"email",type:"text",value:t.email,onChange:r,placeholder:i.emailPlaceholder,language:s,error:o.email,fieldRef:n=>l.current.email=n,icon:Ve,pattern:"[a-z0-9._%+\\-]+@[a-z0-9.\\-]+\\.[a-z]{2,}$"}),e.jsx(ee,{label:i.personalPhone,name:"phone_number",value:t.phone_number,onChange:r,error:o.phone_number,fieldRef:n=>l.current.phone_number=n,language:s,allCountries:A,currentCountryId:t.personal_dial_code_id,onCodeChange:n=>y("personal_dial_code_id",n)}),e.jsxs(k,{label:i.gender,name:"gender",type:"select",value:t.gender,onChange:r,language:s,error:o.gender,fieldRef:n=>l.current.gender=n,icon:O,children:[e.jsx("option",{value:"",children:i.selectGender}),e.jsx("option",{value:"male",children:i.male}),e.jsx("option",{value:"female",children:i.female})]}),e.jsx(aa,{label:i.nationality,name:"country",value:t.country,onChange:v,language:s,error:o.country,fieldRef:n=>l.current.country=n,allCountries:A})]})]}),e.jsxs(N.div,{variants:Q,className:"space-y-6 pt-6 border-t border-gray-700",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-100 border-b border-gray-700 pb-2",children:[L.jobData," ",e.jsx(He,{className:"inline-block w-6 h-6 text-[#FFD700]"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs(k,{label:i.job_id,name:"job_id",type:"select",value:t.job_id,onChange:r,language:s,error:o.job_id,fieldRef:n=>l.current.job_id=n,icon:We,children:[e.jsx("option",{value:"",children:i.selectJob}),f.map(n=>e.jsx("option",{value:n.id,children:s==="ar"?n.name_ar:n.name_en||n.name_ar},n.id))]}),e.jsx(k,{label:i.employee_id,name:"employee_id",type:"text",inputMode:"numeric",value:t.employee_id,onChange:r,placeholder:i.employee_idPlaceholder,language:s,error:o.employee_id,fieldRef:n=>l.current.employee_id=n,icon:Ge,maxLength:10,pattern:"\\d{1,10}"}),e.jsx(k,{label:i.workEmail,name:"work_email",type:"text",value:t.work_email,onChange:r,placeholder:i.workEmailPlaceholder,language:s,error:o.work_email,fieldRef:n=>l.current.work_email=n,icon:_e,pattern:"[a-z0-9._%+\\-]+@[a-z0-9.\\-]+\\.[a-z]{2,}$"}),e.jsx(ee,{label:i.workPhone,name:"work_phone",value:t.work_phone,onChange:r,error:o.work_phone,fieldRef:n=>l.current.work_phone=n,language:s,allCountries:A,currentCountryId:t.work_dial_code_id,onCodeChange:n=>y("work_dial_code_id",n)}),e.jsx(k,{label:i.extensionNumber,name:"landline_phone",type:"text",inputMode:"numeric",value:t.landline_phone,onChange:r,placeholder:"1234",language:s,error:o.landline_phone,fieldRef:n=>l.current.landline_phone=n,icon:ae,maxLength:4,pattern:"\\d{4}"})]})]}),e.jsxs(N.div,{variants:Q,className:"space-y-6 pt-6 border-t border-gray-700",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-100 border-b border-gray-700 pb-2",children:[L.organizationData," ",e.jsx(Ze,{className:"inline-block w-6 h-6 text-[#FFD700]"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.jsxs(k,{label:i.organization,name:"company_id",type:"select",value:t.company_id,onChange:r,language:s,error:o.company_id,fieldRef:n=>l.current.company_id=n,icon:Ke,children:[e.jsx("option",{value:"",children:i.selectOrganization}),q.map(n=>e.jsx("option",{value:n.id,children:s==="ar"?n.name_ar:n.name_en||n.name_ar},n.id))]})}),e.jsx(W,{children:p&&e.jsx(N.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"space-y-6",children:e.jsx(W,{children:R&&e.jsxs(N.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-300 mt-4",children:i.entityContactDetails}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx(k,{label:i.entityEmail,name:"company_email",type:"text",value:t.company_email,onChange:r,placeholder:i.entityEmailPlaceholder,language:s,error:o.company_email,icon:_e,disabled:!R,fieldRef:n=>l.current.company_email=n,pattern:"[a-z0-9._%+\\-]+@[a-z0-9.\\-]+\\.[a-z]{2,}$"}),e.jsx(ee,{label:i.entityPhone,name:"company_phone",value:t.company_phone,onChange:r,error:o.company_phone,fieldRef:n=>l.current.company_phone=n,language:s,allCountries:A,currentCountryId:t.company_dial_code_id,onCodeChange:n=>y("company_dial_code_id",n),disabled:!R}),e.jsx(k,{label:i.entityExtension,name:"company_landline_phone",type:"text",inputMode:"numeric",value:t.company_landline_phone,onChange:r,placeholder:"04xxxxxxxx",language:s,error:o.company_landline_phone,icon:ae,disabled:!R,fieldRef:n=>l.current.company_landline_phone=n,pattern:"\\d+"})]}),e.jsxs("div",{className:"p-4 bg-gray-900/50 rounded-lg shadow-md border border-gray-700",children:[e.jsxs("label",{className:"flex items-center mb-2 font-semibold text-gray-200",children:[e.jsx(ae,{className:"w-5 h-5 me-2 text-[#FFD700]"})," ",i.entityPhoneStatus]}),e.jsxs("div",{className:"flex space-x-4 space-x-reverse",children:[e.jsxs("label",{className:"flex items-center text-gray-300",children:[e.jsx("input",{type:"radio",name:"entity_phone_status",value:"active",checked:a==="active",onChange:C,className:"form-radio text-green-500",disabled:!R}),e.jsx(Ye,{className:"w-5 h-5 mx-1 text-green-500"})," ",i.active]}),e.jsxs("label",{className:"flex items-center text-gray-300",children:[e.jsx("input",{type:"radio",name:"entity_phone_status",value:"stopped",checked:a==="stopped",onChange:C,className:"form-radio text-red-500",disabled:!R}),e.jsx(ne,{className:"w-5 h-5 mx-1 text-red-500"})," ",i.stopped]})]})]}),e.jsx(W,{children:ie&&e.jsxs(N.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"space-y-6 mt-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-red-400",children:i.stoppedPhoneDetails}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(ee,{label:i.alternative_phone,name:"alternative-phone",value:t["alternative-phone"],onChange:r,error:o["alternative-phone"],fieldRef:n=>l.current["alternative-phone"]=n,language:s,allCountries:A,currentCountryId:t.alternative_dial_code_id,onCodeChange:n=>y("alternative_dial_code_id",n)}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(k,{label:i.reason_company_phone,name:"reason-company-phone",type:"textarea",value:t["reason-company-phone"],onChange:r,placeholder:i.reason_company_phonePlaceholder,language:s,error:o["reason-company-phone"],icon:be,fieldRef:n=>l.current["reason-company-phone"]=n})})]})]})})]})})})})]}),e.jsx(N.div,{variants:Q,children:e.jsxs("div",{className:"bg-gray-900/50 border border-yellow-400/50 rounded-lg p-6 mt-4",children:[e.jsx("h2",{className:"text-xl font-bold text-[#FFD700] mb-4 text-center",children:i.confirmBoxTitle}),e.jsx("div",{className:"flex flex-col items-center",children:e.jsxs("div",{className:"relative mt-4 flex flex-col items-center",children:[e.jsx(N.button,{onClick:g,className:"bg-[#FFD700] text-black px-8 py-3 rounded-lg font-bold disabled:bg-gray-600 disabled:text-gray-400 disabled:cursor-not-allowed transition-colors",disabled:F||!T||!D,variants:te,whileHover:"hover",whileTap:"tap",children:F?s==="ar"?"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...":"Submitting...":i.save}),e.jsxs(W,{children:[!T&&e.jsxs(N.div,{variants:ue,initial:"initial",animate:"animate",exit:"exit",className:"mt-3 flex items-center gap-2 text-sm text-red-400",children:[e.jsx(ge,{className:"w-4 h-4"}),e.jsx("span",{children:L.permissionNeededForAction})]}),!D&&e.jsxs(N.div,{variants:ue,initial:"initial",animate:"animate",exit:"exit",className:"mt-3 flex items-center gap-2 text-sm text-red-400",children:[e.jsx(ge,{className:"w-4 h-4"}),e.jsx("span",{children:L.noSignatureMessage})]})]})]})})]})})]})}function ia(){const{language:t}=ye(),{user:r,hasPermission:E,isLoading:q}=xe(),{showDialog:f}=De(),{setPageLoading:A}=Re(),{showActionLoading:g,hideActionLoading:F}=Me(),w=Ae(),{isDirty:l,setIsDirty:o}=$e(),[T,D]=m.useState("active"),[a,C]=m.useState({first_name_ar:"",second_name_ar:"",third_name_ar:"",last_name_ar:"",first_name_en:"",second_name_en:"",third_name_en:"",last_name_en:"",name_ar:"",name_en:"",email:"",phone_number:"",gender:"",country:"",job_id:"",employee_id:"",work_email:"",work_phone:"",landline_phone:"",company_id:"",company_email:"",company_phone:"",company_landline_phone:"","reason-company-phone":"","alternative-phone":"",entity_phone_status:"active",personal_dial_code_id:"AE",work_dial_code_id:"AE",alternative_dial_code_id:"AE",company_dial_code_id:"AE"}),[v,y]=m.useState({}),[s,h]=m.useState(!1),z=m.useRef({}),[V,i]=m.useState(!1),L=E("sss:13"),H=!!r?.signature_url,[X,p]=re(m.useMemo(()=>oe(se(le,"companies").withConverter(Xe),he("name_ar")),[])),[R,ie]=re(m.useMemo(()=>oe(se(le,"jobs").withConverter(Qe),ze(Le(),"==","3")),[])),[n,je]=re(m.useMemo(()=>oe(se(le,"countries").withConverter(ea),he("name_ar")),[])),$=m.useMemo(()=>({ar:{pageTitle:"Ø·Ù„Ø¨ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯",permissionNeededForAction:"Ù„Ø§ ØªÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ø·Ù„Ø¨ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯.",permissionDeniedOnSubmitTitle:"ØªÙ… Ø±ÙØ¶ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡",permissionDeniedOnSubmitMessage:"Ù„Ù‚Ø¯ ØªØºÙŠØ±Øª ØµÙ„Ø§Ø­ÙŠØ§ØªÙƒ ÙˆÙ„Ù… ÙŠØ¹Ø¯ Ø¨Ø¥Ù…ÙƒØ§Ù†Ùƒ ØªÙ†ÙÙŠØ° Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡. Ø³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø©.",noSignatureTitle:"Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ù…Ø·Ù„ÙˆØ¨",noSignatureMessage:"ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ Ø±ÙØ¹ ØªÙˆÙ‚ÙŠØ¹Ùƒ ÙÙŠ Ù…Ù„ÙÙƒ Ø§Ù„Ø´Ø®ØµÙŠ Ø£ÙˆÙ„Ø§Ù‹ Ù‚Ø¨Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨.",personalData:"1. Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©",jobData:"2. Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙˆØ¸ÙŠÙÙŠØ©",organizationData:"3. Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¤Ø³Ø³Ø©",common:{confirmSaveTitle:"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„",confirmSaveMessage:"Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø¥Ù†Ø´Ø§Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ù„Ù…ÙˆØ§ÙÙ‚Ø©ØŸ",validationErrorTitle:"Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„",validationErrorMessage:"ÙŠØ±Ø¬Ù‰ ØªØµØ­ÙŠØ­ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ù…Ø´Ø§Ø± Ø¥Ù„ÙŠÙ‡Ø§ Ø¨Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø­Ù…Ø±.",optionalNotesTitle:"Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)",optionalNotesMessage:"Ø£Ø¶Ù Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ø¶Ø±ÙˆØ±ÙŠØ© Ù„Ø¹Ù…Ù„ÙŠØ© Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù….",requiredField:"Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ø¥Ù„Ø²Ø§Ù…ÙŠ.",validationErrorPhoneLength:"ÙŠØ¬Ø¨ Ø£Ù† ÙŠØªÙƒÙˆÙ† Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù…Ù† 9 Ø£Ø±Ù‚Ø§Ù… (Ø¨Ø¯ÙˆÙ† Ø§Ù„Ù…ÙØªØ§Ø­ Ø£Ùˆ Ø§Ù„ØµÙØ± Ø§Ù„Ø¨Ø§Ø¯Ø¦).",validationErrorExtension:"ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø±Ù‚Ù… Ø§Ù„ØªØ­ÙˆÙŠÙ„Ø© 4 Ø£Ø±Ù‚Ø§Ù….",validationErrorEmployeeID:"ÙŠØ¬Ø¨ Ø£Ù† ÙŠØªÙƒÙˆÙ† Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ¸ÙŠÙÙŠ Ù…Ù† Ø£Ø±Ù‚Ø§Ù… ÙÙ‚Ø· (Ø­Ø¯ Ø£Ù‚ØµÙ‰ 10).",validationErrorArabicFormat:"ÙŠØ¬Ø¨ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø­Ù‚Ù„ Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙÙ‚Ø·.",validationErrorEnglishFormat:"ÙŠØ¬Ø¨ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø­Ù‚Ù„ Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© ÙÙ‚Ø·.",validationErrorEmailFormat:"ØµÙŠØºØ© Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­Ø©.",duplicateEmail:"Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…Ø³Ø¬Ù„ Ù…Ø³Ø¨Ù‚Ø§Ù‹ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù….",duplicatePersonalPhone:"Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ø´Ø®ØµÙŠ Ù‡Ø°Ø§ Ù…Ø³Ø¬Ù„ Ù…Ø³Ø¨Ù‚Ø§Ù‹.",duplicateEmployeeID:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ¸ÙŠÙÙŠ Ù‡Ø°Ø§ Ù…Ø³Ø¬Ù„ Ù…Ø³Ø¨Ù‚Ø§Ù‹.",successTitle:"Ù†Ø¬Ø§Ø­",successMessage:"ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­.",errorTitle:"Ø®Ø·Ø£",genericErrorMessage:"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨.",savingMessage:"Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ù‡Ù…Ø©...",arabicName:"Ø§Ù„Ø§Ø³Ù… (Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©)",englishName:"Ø§Ù„Ø§Ø³Ù… (Ø¨Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©)",firstName:"Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„",secondName:"Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ø§Ù†ÙŠ",thirdName:"Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ø§Ù„Ø«",lastName:"Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©",personalEmail:"Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø§Ù„Ø´Ø®ØµÙŠ",personalPhone:"Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ø´Ø®ØµÙŠ",emailPlaceholder:"example@domain.com",phonePlaceholder:"5xxxxxxxx",gender:"Ø§Ù„Ø¬Ù†Ø³",selectGender:"Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù†Ø³...",male:"Ø°ÙƒØ±",female:"Ø£Ù†Ø«Ù‰",nationality:"Ø§Ù„Ø¬Ù†Ø³ÙŠØ©",selectCountry:"Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù†Ø³ÙŠØ©...",job_id:"Ø§Ù„Ù…Ø³Ù…Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ",selectJob:"Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³Ù…Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ...",employee_id:"Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ¸ÙŠÙÙŠ",employee_idPlaceholder:"12345",workEmail:"Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„",workEmailPlaceholder:"work.email@domain.com",workPhone:"Ù‡Ø§ØªÙ Ø§Ù„Ø¹Ù…Ù„",extensionNumber:"Ø±Ù‚Ù… Ø§Ù„ØªØ­ÙˆÙŠÙ„Ø©",organization:"Ø§Ù„Ù…Ø¤Ø³Ø³Ø©/Ø§Ù„Ù…Ù†Ø´Ø£Ø©",selectOrganization:"Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¤Ø³Ø³Ø©...",entityContactDetails:"Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ù…Ø¤Ø³Ø³Ø© (Ø¨Ø±ÙŠØ¯/Ù‡Ø§ØªÙ)",entityEmail:"Ø¨Ø±ÙŠØ¯ Ø§Ù„Ù…Ø¤Ø³Ø³Ø©",entityEmailPlaceholder:"entity.email@organization.com",entityPhone:"Ù‡Ø§ØªÙ Ø§Ù„Ù…Ø¤Ø³Ø³Ø©",entityExtension:"ØªØ­ÙˆÙŠÙ„Ø© Ø§Ù„Ù…Ø¤Ø³Ø³Ø©",entityPhoneStatus:"Ø­Ø§Ù„Ø© Ù‡Ø§ØªÙ Ø§Ù„Ù…Ø¤Ø³Ø³Ø©",active:"Ù†Ø´Ø·",stopped:"Ù…Ø¹Ø·Ù„",stoppedPhoneDetails:"ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ù…Ø¹Ø·Ù„",reason_company_phone:"Ø³Ø¨Ø¨ ØªÙˆÙ‚Ù Ù‡Ø§ØªÙ Ø§Ù„Ù…Ø¤Ø³Ø³Ø©",reason_company_phonePlaceholder:"Ø³Ø¨Ø¨ Ø¹Ø¯Ù… ØªÙˆØ§ÙØ± Ø£Ùˆ Ø¹Ù…Ù„ Ù‡Ø§ØªÙ Ø§Ù„Ù…Ø¤Ø³Ø³Ø©...",alternative_phone:"Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ø¨Ø¯ÙŠÙ„",save:"Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨"}},en:{pageTitle:"New User Request",permissionNeededForAction:"You do not have permission to request a new user.",permissionDeniedOnSubmitTitle:"Action Denied",permissionDeniedOnSubmitMessage:"Your permissions have changed, and you can no longer perform this action. The page will be updated.",noSignatureTitle:"Signature Required",noSignatureMessage:"You must upload your signature in your profile before submitting a request.",personalData:"1. Personal Data",jobData:"2. Job Data",organizationData:"3. Organization Data",common:{confirmSaveTitle:"Confirm Submission",confirmSaveMessage:"Are you sure you want to submit this new user request for approval?",validationErrorTitle:"Input Error",validationErrorMessage:"Please correct the errors indicated in red.",optionalNotesTitle:"Additional Notes (Optional)",optionalNotesMessage:"Add any additional notes necessary for the user creation process.",requiredField:"This field is required.",validationErrorPhoneLength:"The phone number must be 9 digits (excluding dial code or leading zero).",validationErrorExtension:"Extension number must be 4 digits.",validationErrorEmployeeID:"Employee ID must be numbers only (max 10 digits).",validationErrorArabicFormat:"Field must be in Arabic only.",validationErrorEnglishFormat:"Field must be in English only.",validationErrorEmailFormat:"Invalid email format.",duplicateEmail:"This email address is already registered.",duplicatePersonalPhone:"This personal phone number is already registered.",duplicateEmployeeID:"This Employee ID is already registered.",successTitle:"Success",successMessage:"User request submitted successfully.",errorTitle:"Error",genericErrorMessage:"An error occurred while submitting the request.",savingMessage:"Submitting request and creating task...",arabicName:"Name (Arabic)",englishName:"Name (English)",firstName:"First Name",secondName:"Second Name",thirdName:"Third Name",lastName:"Last Name",personalEmail:"Personal Email",personalPhone:"Personal Phone Number",emailPlaceholder:"example@domain.com",phonePlaceholder:"5xxxxxxxx",gender:"Gender",selectGender:"Select gender...",male:"Male",female:"Female",nationality:"Nationality",selectCountry:"Select Nationality...",job_id:"Job Title",selectJob:"Select job title...",employee_id:"Employee ID",employee_idPlaceholder:"12345",workEmail:"Work Email",workEmailPlaceholder:"work.email@domain.com",workPhone:"Work Phone",extensionNumber:"Extension Number",organization:"Organization/Entity",selectOrganization:"Select Organization...",entityContactDetails:"Entity Contact Details (Email/Phone)",entityEmail:"Entity Email",entityEmailPlaceholder:"entity.email@organization.com",entityPhone:"Entity Phone",entityExtension:"Entity Extension",entityPhoneStatus:"Entity Phone Status",active:"Active",stopped:"Stopped",stoppedPhoneDetails:"Stopped Phone Details",reason_company_phone:"Reason for Entity Phone Stoppage",reason_company_phonePlaceholder:"Reason the entity phone is unavailable or not working...",alternative_phone:"Alternative Phone Number",save:"Submit Request"}}}),[t]),S=$[t].common;$[t];const Ne=b=>{const{name:u,value:x}=b.target;C(_=>{const d={..._,[u]:x};if(u.endsWith("_ar")){const I=[d.first_name_ar,d.second_name_ar,d.third_name_ar,d.last_name_ar];d.name_ar=I.filter(P=>j(P)).join(" ")}if(u.endsWith("_en")){const I=[d.first_name_en,d.second_name_en,d.third_name_en,d.last_name_en];d.name_en=I.filter(P=>j(P)).join(" ")}return d}),v[u]&&y(_=>({..._,[u]:void 0}))},Ee=b=>{const{name:u,value:x}=b.target;C(_=>{const d={..._,[u]:x};return u==="company_id"&&x==="1"&&(d.company_email="",d.company_phone="",d.company_landline_phone="",d["reason-company-phone"]="",d["alternative-phone"]="",d.entity_phone_status="active",D("active")),d}),v[u]&&y(_=>({..._,[u]:void 0}))},Fe=m.useCallback((b,u)=>{C(x=>{const _={...x,[b]:u};return b==="personal_dial_code_id"?(_.phone_number="",v.phone_number&&y(d=>({...d,phone_number:void 0}))):b==="company_dial_code_id"&&(_.company_phone="",v.company_phone&&y(d=>({...d,company_phone:void 0}))),_})},[v.phone_number,v.company_phone]),Ce=b=>{const u=b.target.value;C(x=>({...x,country:u})),v.country&&y(x=>({...x,country:void 0}))},ke=b=>{const u=b.target.value;D(u),C(x=>{const _={...x,entity_phone_status:u};return u==="active"&&(_["reason-company-phone"]="",_["alternative-phone"]=""),_})},ce=q||p||ie||je;m.useEffect(()=>{ce||V||i(!0)},[ce,V]),m.useEffect(()=>{A(!V)},[V,A]);const Se=m.useCallback(()=>{C({first_name_ar:"",second_name_ar:"",third_name_ar:"",last_name_ar:"",first_name_en:"",second_name_en:"",third_name_en:"",last_name_en:"",name_ar:"",name_en:"",email:"",phone_number:"",gender:"",country:"",job_id:"",employee_id:"",work_email:"",work_phone:"",landline_phone:"",company_id:"",company_email:"",company_phone:"",company_landline_phone:"","reason-company-phone":"","alternative-phone":"",entity_phone_status:"active",personal_dial_code_id:"AE",work_dial_code_id:"AE",alternative_dial_code_id:"AE",company_dial_code_id:"AE"}),y({}),o(!1)},[o]),Pe=async()=>{if(!H){f({variant:"alert",title:$[t].noSignatureTitle,message:$[t].noSignatureMessage});return}if(!L){f({variant:"alert",title:$[t].permissionDeniedOnSubmitTitle,message:$[t].permissionDeniedOnSubmitMessage});return}const b={},u=["first_name_ar","second_name_ar","third_name_ar","last_name_ar","first_name_en","second_name_en","third_name_en","last_name_en","email","phone_number","gender","country","job_id","company_id","employee_id"];let x=null;const _=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,d=/^[\u0600-\u06FF\s]+$/,I=/^[a-zA-Z\s]+$/,P=9,J=c=>{b[c]=S.requiredField,x||(x=c)},U=(c,M)=>{b[c]=M,x||(x=c)};for(const c of u){const M=a[c];(!M||j(M).length===0)&&J(c)}["first_name_ar","second_name_ar","third_name_ar","last_name_ar"].forEach(c=>{a[c]&&!d.test(a[c])&&U(c,S.validationErrorArabicFormat)}),["first_name_en","second_name_en","third_name_en","last_name_en"].forEach(c=>{a[c]&&!I.test(a[c])&&U(c,S.validationErrorEnglishFormat)}),a.email&&!_.test(a.email)&&U("email",S.validationErrorEmailFormat),a.work_email&&j(a.work_email).length>0&&!_.test(a.work_email)&&U("work_email",S.validationErrorEmailFormat),a.company_email&&j(a.company_email).length>0&&!_.test(a.company_email)&&U("company_email",S.validationErrorEmailFormat),a.employee_id&&j(a.employee_id).length>0&&!/^\d{1,10}$/.test(a.employee_id)&&U("employee_id",S.validationErrorEmployeeID),a.landline_phone&&j(a.landline_phone).length>0&&!/^\d{4}$/.test(a.landline_phone)&&U("landline_phone",S.validationErrorExtension);const Z=(c,M)=>{c&&!b[M]&&B(c).length!==P&&U(M,S.validationErrorPhoneLength)};if(Z(a.phone_number,"phone_number"),a.work_phone&&j(a.work_phone).length>0&&Z(a.work_phone,"work_phone"),a.company_id!=="1"&&(!a.company_phone||j(a.company_phone).length===0)?J("company_phone"):a.company_id!=="1"&&a.company_phone&&Z(a.company_phone,"company_phone"),a.company_id!=="1"&&T==="stopped"){const c="alternative-phone",M="reason-company-phone";!a[c]||j(a[c]).length===0?J(c):Z(a[c],c),(!a[M]||j(a[M]).length===0)&&J(M)}if(x||Object.keys(b).length>0){y({}),setTimeout(()=>{const c=Object.keys(b),me=u.find(Y=>b[Y])||c.find(Y=>b[Y]),pe=z.current[me];pe&&pe.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{const Y={...b};y(Y),f({variant:"alert",title:$[t].common.validationErrorTitle,message:$[t].common.validationErrorMessage})},400)},50);return}f({variant:"prompt",title:S.optionalNotesTitle,message:S.optionalNotesMessage,icon:be,color:"blue",isDismissable:!0,validation:c=>null,onConfirm:c=>{const M=j(c||"");Te(M)}})},Te=async b=>{h(!0),o(!1),g(S.savingMessage);try{const u=await Oe(),x=n||[],_=K=>x.find(Z=>Z.id===K)?.dial_code||"+971",d=a.company_id==="1",I={name_ar:a.name_ar,name_en:a.name_en,email:a.email,phone_number:_(a.personal_dial_code_id)+B(a.phone_number),gender:a.gender,country:a.country,job_id:Number(a.job_id),employee_id:a.employee_id,company_id:a.company_id,first_name_ar:a.first_name_ar,second_name_ar:a.second_name_ar,third_name_ar:a.third_name_ar,last_name_ar:a.last_name_ar,first_name_en:a.first_name_en,second_name_en:a.second_name_en,third_name_en:a.third_name_en,last_name_en:a.last_name_en,work_email:a.work_email,work_phone:a.work_phone?_(a.work_dial_code_id)+B(a.work_phone):"",landline_phone:a.landline_phone,notes:b};let P={};d?P={company_email:"",company_phone:"",company_landline_phone:"","reason-company-phone":"","alternative-phone":""}:(P={company_email:a.company_email,company_phone:a.company_phone?_(a.company_dial_code_id)+B(a.company_phone):"",company_landline_phone:a.company_landline_phone},T==="stopped"?(P["reason-company-phone"]=a["reason-company-phone"],P["alternative-phone"]=a["alternative-phone"]?_(a.alternative_dial_code_id)+B(a["alternative-phone"]):""):(P["reason-company-phone"]="",P["alternative-phone"]=""));const J={...I,...P};Object.keys(J).forEach(K=>{const G=J[K];(G===null||typeof G=="string"&&j(G).length===0||G==="")&&delete J[K]}),await qe(Je,"requestNewUser")({requestData:J,clientContext:u}),Se(),f({variant:"success",title:$[t].common.successTitle,message:$[t].common.successMessage,onConfirm:()=>{w("/tasks")}})}catch(u){const x=u.code||"",_={"exists/email":{field:"email",message:S.duplicateEmail},"exists/phone_number":{field:"phone_number",message:S.duplicatePersonalPhone},"exists/employee_id":{field:"employee_id",message:S.duplicateEmployeeID}};if(_[x]){const{field:d,message:I}=_[x];y({[d]:I}),f({variant:"alert",title:S.errorTitle,message:I});const P=z.current[d];P&&P.scrollIntoView({behavior:"smooth",block:"center"})}else f({variant:"alert",title:$[t].common.errorTitle,message:u.message||$[t].common.genericErrorMessage});o(!0)}finally{F(),h(!1)}};return e.jsx(W,{mode:"wait",children:e.jsx(N.div,{custom:t,variants:Ie,initial:"initial",animate:"animate",exit:"exit",children:e.jsx(na,{formData:a,onFormChange:Ee,onNameChange:Ne,onCountrySelectChange:Ce,onPhoneCodeChange:Fe,entityPhoneStatus:T,onPhoneStatusChange:ke,allCompanies:X||[],allJobs:R||[],allCountries:n||[],onSubmit:Pe,isSubmitting:s,translations:$,formRefs:z,formErrors:v,showDialog:f,userHasSignature:H,canPerformSaveAction:L})},t)})}export{ia as default};
