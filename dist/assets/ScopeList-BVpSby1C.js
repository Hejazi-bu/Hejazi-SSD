import{r as t,u as C,k as e,v as F,J as k,A as M,m as E,B}from"./index-AlbxRJrk.js";import{F as S,a as D}from"./TrashIcon-DqVoRP7K.js";import{F as y}from"./UserGroupIcon-Q_vkDVVC.js";function J({title:l,titleId:d,...m},p){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:p,"aria-labelledby":d},m),l?t.createElement("title",{id:d},l):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21v-8.25M15.75 21v-8.25M8.25 21v-8.25M3 9l9-6 9 6m-1.5 12V10.332A48.36 48.36 0 0 0 12 9.75c-2.551 0-5.056.2-7.5.582V21M3 21h18M12 6.75h.008v.008H12V6.75Z"}))}const R=t.forwardRef(J),O=({jobs:l,companies:d,sectors:m,departments:p,sections:u,onAddRule:b,t:f})=>{const{language:v}=C(),c=v==="ar",[o,n]=t.useState(""),[a,r]=t.useState(""),[i,g]=t.useState(""),[x,N]=t.useState(""),[w,j]=t.useState(""),[h,_]=t.useState(!1),L=p.filter(s=>!i||String(s.sector_id)===String(i)),$=u.filter(s=>!x||String(s.department_id)===String(x)),A=()=>{if(!o)return;b({target_job_id:o,scope_company_id:a||null,restricted_to_company:h,scope_sector_id:i||null,scope_department_id:x||null,scope_section_id:w||null}),n("")};return e.jsxs("div",{className:"bg-gray-800/30 border border-gray-700 rounded-xl p-4 mb-6",children:[e.jsxs("h3",{className:"text-sm font-bold text-blue-400 mb-4 flex items-center gap-2",children:[e.jsx(S,{className:"w-4 h-4"})," إضافة قاعدة نطاق جديدة"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"text-xs text-gray-400",children:["الوظيفة المستهدفة ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:o,onChange:s=>n(s.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg p-2 pl-9 text-sm text-white focus:border-blue-500 appearance-none",children:[e.jsx("option",{value:"",children:"اختر الوظيفة..."}),e.jsx("option",{value:"ALL",children:"-- كل الوظائف --"}),l.map(s=>e.jsx("option",{value:s.id,children:c?s.name_ar:s.name_en},s.id))]}),e.jsx(F,{className:"w-4 h-4 text-gray-500 absolute left-3 top-2.5 pointer-events-none"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-gray-400",children:"الشركة (النطاق)"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:a,onChange:s=>{r(s.target.value),s.target.value&&_(!1)},disabled:h,className:`w-full bg-gray-900 border border-gray-600 rounded-lg p-2 pl-9 text-sm text-white focus:border-blue-500 appearance-none ${h?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx("option",{value:"",children:"-- كل الشركات --"}),d.map(s=>e.jsx("option",{value:s.id,children:c?s.name_ar:s.name_en},s.id))]}),e.jsx(k,{className:"w-4 h-4 text-gray-500 absolute left-3 top-2.5 pointer-events-none"})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("input",{type:"checkbox",id:"restricted",checked:h,onChange:s=>{_(s.target.checked),s.target.checked&&r("")},className:"rounded bg-gray-700 border-gray-600 text-blue-500 focus:ring-0"}),e.jsx("label",{htmlFor:"restricted",className:"text-[10px] text-gray-400 cursor-pointer select-none",children:"قصر النطاق على شركة الموظف المانح فقط"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-gray-400",children:"القطاع"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:i,onChange:s=>{g(s.target.value),N(""),j("")},className:"w-full bg-gray-900 border border-gray-600 rounded-lg p-2 pl-9 text-sm text-white focus:border-blue-500 appearance-none",children:[e.jsx("option",{value:"",children:"-- كل القطاعات --"}),m.map(s=>e.jsx("option",{value:s.id,children:c?s.name_ar:s.name_en},s.id))]}),e.jsx(R,{className:"w-4 h-4 text-gray-500 absolute left-3 top-2.5 pointer-events-none"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-gray-400",children:"الإدارة"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:x,onChange:s=>{N(s.target.value),j("")},className:"w-full bg-gray-900 border border-gray-600 rounded-lg p-2 pl-9 text-sm text-white focus:border-blue-500 appearance-none",children:[e.jsx("option",{value:"",children:"-- كل الإدارات --"}),L.map(s=>e.jsx("option",{value:s.id,children:c?s.name_ar:s.name_en},s.id))]}),e.jsx(y,{className:"w-4 h-4 text-gray-500 absolute left-3 top-2.5 pointer-events-none"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-gray-400",children:"القسم"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:w,onChange:s=>j(s.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg p-2 pl-9 text-sm text-white focus:border-blue-500 appearance-none",children:[e.jsx("option",{value:"",children:"-- كل الأقسام --"}),$.map(s=>e.jsx("option",{value:s.id,children:c?s.name_ar:s.name_en},s.id))]}),e.jsx(y,{className:"w-4 h-4 text-gray-500 absolute left-3 top-2.5 pointer-events-none"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("button",{onClick:A,disabled:!o,className:`w-full py-2 rounded-lg font-bold flex items-center justify-center gap-2 transition-all ${o?"bg-blue-500 hover:bg-blue-600 text-white shadow-lg shadow-blue-500/20":"bg-gray-700 text-gray-500 cursor-not-allowed"}`,children:[e.jsx(S,{className:"w-5 h-5"})," إضافة القاعدة"]})})]})]})},P=({rules:l,onRemove:d,jobs:m,companies:p,sectors:u,departments:b,sections:f,t:v})=>{const{language:c}=C(),o=c==="ar",n=(a,r,i)=>{if(!r)return i;const g=a.find(x=>String(x.id)===String(r));return g?o?g.name_ar:g.name_en:r};return!l||l.length===0?e.jsxs("div",{className:"text-center py-10 border-2 border-dashed border-gray-700/50 rounded-xl bg-gray-800/20",children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"لا توجد قواعد نطاق مضافة حالياً."}),e.jsx("p",{className:"text-gray-600 text-xs mt-1",children:"استخدم النموذج أعلاه لإضافة قاعدة جديدة."})]}):e.jsx("div",{className:"space-y-3",children:e.jsx(M,{mode:"popLayout",children:l.map((a,r)=>e.jsxs(E.div,{initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,scale:.9,transition:{duration:.2}},layout:!0,className:"bg-gray-800 border border-gray-700 rounded-lg p-4 flex items-start justify-between group hover:border-blue-500/30 hover:bg-gray-800/80 transition-all shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"bg-blue-500/10 p-1.5 rounded-md border border-blue-500/20",children:e.jsx(F,{className:"w-4 h-4 text-blue-400"})}),e.jsx("span",{className:"text-gray-400 text-xs",children:"يتحكم في وظيفة:"}),e.jsx("span",{className:"text-white font-bold text-sm",children:a.target_job_id==="ALL"?"كل الوظائف":n(m,a.target_job_id,"وظيفة غير معروفة")})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-y-2 text-xs bg-gray-900/50 p-2 rounded-md border border-gray-700/50 w-fit max-w-full",children:[e.jsx("span",{className:"text-gray-500 pl-2 rtl:border-l border-gray-700 ml-2",children:"النطاق:"}),e.jsx("div",{className:"flex items-center gap-1 text-gray-300",children:a.restricted_to_company?e.jsxs("span",{className:"flex items-center gap-1 text-orange-400 bg-orange-400/10 px-2 py-0.5 rounded text-[10px] border border-orange-400/20",children:[e.jsx(B,{className:"w-3 h-3"})," نفس شركة الموظف"]}):e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(k,{className:"w-3 h-3 text-gray-500"}),n(p,a.scope_company_id,"كل الشركات")]})}),a.scope_sector_id&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-600 mx-1",children:"/"}),e.jsxs("span",{className:"flex items-center gap-1 text-gray-300",children:[e.jsx(R,{className:"w-3 h-3 text-gray-500"}),n(u,a.scope_sector_id,"")]})]}),a.scope_department_id&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-600 mx-1",children:"/"}),e.jsxs("span",{className:"flex items-center gap-1 text-gray-300",children:[e.jsx(y,{className:"w-3 h-3 text-gray-500"}),n(b,a.scope_department_id,"")]})]}),a.scope_section_id&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-600 mx-1",children:"/"}),e.jsxs("span",{className:"flex items-center gap-1 text-gray-300",children:[e.jsx("span",{className:"text-gray-500 text-[10px] border border-gray-600 px-1 rounded",children:"قسم"}),n(f,a.scope_section_id,"")]})]})]})]}),e.jsx("button",{onClick:()=>d(r),className:"text-gray-500 hover:text-red-400 hover:bg-red-500/10 p-2 rounded-lg transition-colors self-center ml-2",children:e.jsx(D,{className:"w-5 h-5"})})]},`${r}-${a.target_job_id}`))})})};export{O as S,P as a};
