# Cloud Functions Testing Guide
## ๐งช ุงุฎุชุจุงุฑุงุช ุงูุฏูุงู ุงูุณุญุงุจูุฉ - ุฏููู ุดุงูู

ูุฐุง ุงูุฏููู ูุดุฑุญ ููููุฉ ุชุดุบูู ูุงุณุชุฎุฏุงู ุงูุงุฎุชุจุงุฑุงุช ููุฏูุงู ุงูุณุญุงุจูุฉ (Cloud Functions) ูู ุงููุดุฑูุน.

---

## ๐ ุฌุฏูู ุงููุญุชููุงุช

1. [ูุธุฑุฉ ุนุงูุฉ](#ูุธุฑุฉ-ุนุงูุฉ)
2. [ุงูุจููุฉ ุงูุชุญุชูุฉ ููุงุฎุชุจุงุฑุงุช](#ุงูุจููุฉ-ุงูุชุญุชูุฉ-ููุงุฎุชุจุงุฑุงุช)
3. [ุชุดุบูู ุงูุงุฎุชุจุงุฑุงุช](#ุชุดุบูู-ุงูุงุฎุชุจุงุฑุงุช)
4. [ุชุบุทูุฉ ุงูุงุฎุชุจุงุฑุงุช](#ุชุบุทูุฉ-ุงูุงุฎุชุจุงุฑุงุช)
5. [ูููุงุช ุงูุงุฎุชุจุงุฑ](#ูููุงุช-ุงูุงุฎุชุจุงุฑ)
6. [ุงุณุชุฑุงุชูุฌูุฉ ุงูุงุฎุชุจุงุฑ](#ุงุณุชุฑุงุชูุฌูุฉ-ุงูุงุฎุชุจุงุฑ)

---

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅูุดุงุก ูุฌููุนุฉ ุดุงููุฉ ูู ุงูุงุฎุชุจุงุฑุงุช ูุฌููุน ุงูุฏูุงู ุงูุณุญุงุจูุฉ ุงูุฃุฑุจุนุฉ ุงููุณุคููุฉ ุนู ุฅุฏุงุฑุฉ ุงูุฃุฐููุงุช:

- โ **checkPermission** - ุงูุชุญูู ูู ุตูุงุญูุฉ ุงููุณุชุฎุฏู ูููุตูู ุฅูู ุฎุฏูุฉ ูุนููุฉ
- โ **getUserEffectivePermissions** - ุงูุญุตูู ุนูู ุฌููุน ุงูุตูุงุญูุงุช ุงููุนุงูุฉ ูููุณุชุฎุฏู
- โ **manageUserPermissions** - ุฅุฏุงุฑุฉ ุงุณุชุซูุงุกุงุช ุตูุงุญูุงุช ุงููุณุชุฎุฏููู
- โ **manageJobPermissions** - ุฅุฏุงุฑุฉ ุตูุงุญูุงุช ุงููุธุงุฆู

### ุฅุญุตุงุฆูุงุช ุงูุชุบุทูุฉ

| ุงูุฏุงูุฉ | ุนุฏุฏ ุงูุงุฎุชุจุงุฑุงุช | ุงูุณููุงุฑูููุงุช ุงููุบุทุงุฉ |
|--------|----------------|----------------------|
| checkPermission | 40+ | ูุตุงุฏูุฉุ ุตูุงุญูุงุช ุณูุจุฑ ุฃุฏููุ ุตูุงุญูุงุช ุงููุธุงุฆูุ ุงูุงุณุชุซูุงุกุงุชุ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก |
| getUserEffectivePermissions | 35+ | ูุตุงุฏูุฉุ ุณูุจุฑ ุฃุฏููุ ุฏูุฌ ุงูุตูุงุญูุงุชุ ุงูุงุณุชุซูุงุกุงุช |
| manageUserPermissions | 30+ | ูุตุงุฏูุฉุ ููุทู ูุนูุฏ ููุงุณุชุซูุงุกุงุชุ ุนูููุงุช ุฏูุนูุฉ |
| manageJobPermissions | 30+ | ูุตุงุฏูุฉุ ุฅุถุงูุฉ/ุญุฐู ุงูุตูุงุญูุงุชุ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก |

---

## ุงูุจููุฉ ุงูุชุญุชูุฉ ููุงุฎุชุจุงุฑุงุช

### ุงูููุชุจุงุช ุงููุณุชุฎุฏูุฉ

- **Mocha** - ุฅุทุงุฑ ุนูู ุงูุงุฎุชุจุงุฑ
- **Chai** - ููุชุจุฉ ุงูุชุฃููุฏุงุช (Assertions)
- **Sinon** - ููุชุจุฉ ุงูู Mocking ูุงูู Stubbing
- **firebase-functions-test** - ููุชุจุฉ ุงุฎุชุจุงุฑ ุงูุฏูุงู ุงูุณุญุงุจูุฉ ูู Firebase
- **ts-node** - ุชุดุบูู TypeScript ูุจุงุดุฑุฉ
- **nyc** - ููุงุณ ุชุบุทูุฉ ุงูููุฏ

### ูููู ุงููุฌูุฏ

```
functions/
โโโ test/
โ   โโโ setup.ts                              # ุฅุนุฏุงุฏุงุช ุงูุงุฎุชุจุงุฑ ูุงูู Fixtures
โ   โโโ checkPermission.test.ts               # ุงุฎุชุจุงุฑุงุช checkPermission
โ   โโโ getUserEffectivePermissions.test.ts   # ุงุฎุชุจุงุฑุงุช getUserEffectivePermissions
โ   โโโ manageUserPermissions.test.ts         # ุงุฎุชุจุงุฑุงุช manageUserPermissions
โ   โโโ manageJobPermissions.test.ts          # ุงุฎุชุจุงุฑุงุช manageJobPermissions
โ   โโโ README.md                             # ูุฐุง ุงูููู
โโโ .mocharc.json                             # ุฅุนุฏุงุฏุงุช Mocha
โโโ .nycrc.json                               # ุฅุนุฏุงุฏุงุช ุชุบุทูุฉ ุงูููุฏ
โโโ tsconfig.test.json                        # ุฅุนุฏุงุฏุงุช TypeScript ููุงุฎุชุจุงุฑุงุช
โโโ package.json                              # ุณูุฑุจุชุงุช ุงูุงุฎุชุจุงุฑ
```

---

## ุชุดุบูู ุงูุงุฎุชุจุงุฑุงุช

### ุงููุชุทูุจุงุช ุงูุฃุณุงุณูุฉ

1. **ุชุซุจูุช ุงูููุชุจุงุช:**
   ```bash
   cd functions
   npm install
   ```

2. **ุชุดุบูู Firestore Emulator (ุงุฎุชูุงุฑู ููู ููุตู ุจู):**
   ```bash
   # ูู terminal ูููุตู
   firebase emulators:start --only firestore
   ```

   **ููุงุญุธุฉ:** ุงูุงุฎุชุจุงุฑุงุช ูููุฃุฉ ููุนูู ูุน Emulator ุนูู `localhost:8080`

### ุฃูุงูุฑ ุงูุชุดุบูู

#### 1. ุชุดุบูู ุฌููุน ุงูุงุฎุชุจุงุฑุงุช
```bash
npm test
```

#### 2. ุชุดุบูู ุงูุงุฎุชุจุงุฑุงุช ูุน ุงููุฑุงูุจุฉ (Watch Mode)
```bash
npm run test:watch
```

#### 3. ุชุดุบูู ุงูุงุฎุชุจุงุฑุงุช ูุน ููุงุณ ุงูุชุบุทูุฉ
```bash
npm run test:coverage
```

ุณูุชู ุฅูุดุงุก ุชูุฑูุฑ ุชุบุทูุฉ ูู ุงููุฌูุฏ `coverage/` ููููู ูุชุญู ุจุงููุชุตูุญ:
```bash
open coverage/index.html
```

---

## ุชุบุทูุฉ ุงูุงุฎุชุจุงุฑุงุช

### ูุนุงููุฑ ุงูุชุบุทูุฉ ุงููุทููุจุฉ

ุชู ุชูููู ุงูุงุฎุชุจุงุฑุงุช ูููุทุงูุจุฉ ุจุชุบุทูุฉ **80%** ูุญุฏ ุฃุฏูู ูู ุฌููุน ุงูููุงููุณ:

- โ **Statements** (ุงูุชุนูููุงุช): 80%
- โ **Branches** (ุงูุชูุฑุนุงุช): 80%
- โ **Functions** (ุงูุฏูุงู): 80%
- โ **Lines** (ุงูุฃุณุทุฑ): 80%

---

## ูููุงุช ุงูุงุฎุชุจุงุฑ

### 1. setup.ts - ููู ุงูุฅุนุฏุงุฏุงุช ุงูุฃุณุงุณู

ูุญุชูู ุนูู:
- ุชููุฆุฉ Firebase Admin ู firebase-functions-test
- ุฅุนุฏุงุฏุงุช Firestore Emulator
- ุจูุงูุงุช ุงุฎุชุจุงุฑ ุฌุงูุฒุฉ (Mock Data / Fixtures)
- ุฏูุงู ูุณุงุนุฏุฉ ููุงุฎุชุจุงุฑ (Test Utilities)

**ุงูุฏูุงู ุงููุณุงุนุฏุฉ:**
- `createCallableRequest()` - ุฅูุดุงุก ุทูุจ callable function
- `clearFirestoreCollections()` - ูุณุญ ูุฌููุนุงุช Firestore ูุจู ุงูุงุฎุชุจุงุฑุงุช
- `seedFirestore()` - ููุก Firestore ุจุจูุงูุงุช ุงุฎุชุจุงุฑูุฉ
- `cleanup()` - ุชูุธูู ุจุนุฏ ุงูุงุฎุชุจุงุฑุงุช

**ุงูุจูุงูุงุช ุงูุฌุงูุฒุฉ:**
- `mockUsers` - ูุณุชุฎุฏููู ูููููู (ุณูุจุฑ ุฃุฏููุ ุนุงุฏูุ ุจุฏูู ูุธููุฉุ ูุญุธูุฑ)
- `mockPermissions` - ูุนุฑูุงุช ุตูุงุญูุงุช ููุงุฎุชุจุงุฑ
- `mockJobPermissions` - ุตูุงุญูุงุช ูุธุงุฆู
- `mockUserPermissions` - ุงุณุชุซูุงุกุงุช ุตูุงุญูุงุช ุงููุณุชุฎุฏููู

---

### 2. checkPermission.test.ts

**ุงูุบุฑุถ:** ุงุฎุชุจุงุฑ ุฏุงูุฉ `checkPermission()` ุงูุชู ุชุชุญูู ูู ุตูุงุญูุฉ ุงููุณุชุฎุฏู ูููุตูู ุฅูู ุฎุฏูุฉ ูุนููุฉ.

**ุงูุฃูุณุงู:**

#### ๐ ุงููุณู 1: ุงููุตุงุฏูุฉ ูุงูุชูููุถ
- ุฑูุถ ุงูุทูุจุงุช ุบูุฑ ุงููุตุงุฏู ุนูููุง
- ุฑูุถ ุงูุทูุจุงุช ูููุณุชุฎุฏููู ุบูุฑ ุงูููุฌูุฏูู

#### ๐ ุงููุณู 2: ุตูุงุญูุงุช ุงูุณูุจุฑ ุฃุฏูู
- ุงูุณูุจุฑ ุฃุฏูู ูุฏูู ุตูุงุญูุฉ ูุงููุฉ ููู ุดูุก
- ุชุฌุงูุฒ ุฌููุน ูุญูุตุงุช ุงูุตูุงุญูุงุช

#### ๐ผ ุงููุณู 3: ุงูุตูุงุญูุงุช ุงููุจููุฉ ุนูู ุงููุธููุฉ
- ุงูุณูุงุญ/ุงูุฑูุถ ุจูุงุกู ุนูู ุตูุงุญูุงุช ุงููุธููุฉ
- ุงูุชูููุฒ ุจูู ุงูุตูุงุญูุงุช (service vs sub_service vs sub_sub_service)

#### โ๏ธ ุงููุณู 4: ุงุณุชุซูุงุกุงุช ุงููุณุชุฎุฏููู
- ุฅุถุงูุฉ ุตูุงุญูุงุช ุนุจุฑ ุงูุงุณุชุซูุงุกุงุช
- ุฅูุบุงุก ุตูุงุญูุงุช ุงููุธููุฉ ุนุจุฑ ุงูุงุณุชุซูุงุกุงุช
- ุฃููููุฉ ุงูุงุณุชุซูุงุกุงุช ุนูู ุตูุงุญูุงุช ุงููุธููุฉ

#### ๐ ุงููุณู 5: ูุนุงูุฌุฉ ูุนุฑูุงุช ุงูุตูุงุญูุงุช
- ุชุญููู `s:X`, `ss:X`, `sss:X` ุจุดูู ุตุญูุญ
- ูุนุงูุฌุฉ ุงููุนุฑูุงุช ุงูุฎุงุทุฆุฉ ุจุฃูุงู

#### ๐งช ุงููุณู 6: ุญุงูุงุช ุฎุงุตุฉ
- ุงููุณุชุฎุฏููู ุจุฏูู `job_id`
- ุงูุตูุงุญูุงุช ุจููู null
- ุฃุญุฑู ุฎุงุตุฉ ูู ุงููุนุฑูุงุช

#### ๐ ุงููุณู 7: ุณููุงุฑูููุงุช ูุนูุฏุฉ
- ุฏูุฌ ุตูุงุญูุงุช ุงููุธููุฉ + ุงุณุชุซูุงุกุงุช ุงููุณุชุฎุฏู
- ุนุฏุฉ ุณููุงุฑูููุงุช ูุชุฏุงุฎูุฉ

---

### 3. getUserEffectivePermissions.test.ts

**ุงูุบุฑุถ:** ุงุฎุชุจุงุฑ ุฏุงูุฉ `getUserEffectivePermissions()` ุงูุชู ุชูุฑุฌุน ุฌููุน ุงูุตูุงุญูุงุช ุงููุนุงูุฉ ูููุณุชุฎุฏู.

**ุงูุฃูุณุงู:**

#### ๐ ุงููุณู 1: ุงููุตุงุฏูุฉ
- ุฑูุถ ุงูุทูุจุงุช ุบูุฑ ุงููุตุงุฏู ุนูููุง
- ุฅุฑุฌุงุน `general_access: true` ุฏุงุฆูุงู

#### ๐ ุงููุณู 2: ุงูุณูุจุฑ ุฃุฏูู - ุงููุตูู ุงููุงูู
- ุฅุฑุฌุงุน ุฌููุน ุงูุฎุฏูุงุช
- ุฅุฑุฌุงุน ุฌููุน ุงูุฎุฏูุงุช ุงููุฑุนูุฉ
- ุฅุฑุฌุงุน ุฌููุน ุงูุฎุฏูุงุช ุงููุฑุนูุฉ ูู ุงููุณุชูู ุงูุซุงูุซ

#### ๐ผ ุงููุณู 3: ุงูุตูุงุญูุงุช ุงููุจููุฉ ุนูู ุงููุธููุฉ
- ุฌูุจ ุตูุงุญูุงุช ุงููุธููุฉ ููุท
- ุนุฏู ุชุถููู ุตูุงุญูุงุช ุงููุธุงุฆู ุงูุฃุฎุฑู
- ุฏุนู ูุณุชููุงุช ูุชุนุฏุฏุฉ

#### โ๏ธ ุงููุณู 4: ุงุณุชุซูุงุกุงุช ุงููุณุชุฎุฏููู
- ุฅุถุงูุฉ ุตูุงุญูุงุช (is_allowed=true)
- ุฅุฒุงูุฉ ุตูุงุญูุงุช (is_allowed=false)
- ุฏูุฌ ุตูุงุญูุงุช ุงููุธููุฉ + ุงูุงุณุชุซูุงุกุงุช

#### ๐งช ุงููุณู 5: ุญุงูุงุช ุฎุงุตุฉ
- ุงููุณุชุฎุฏููู ุจุฏูู ูุธููุฉ
- ุงูุตูุงุญูุงุช ุจููู null
- ุตูุงุญูุงุช ุฎุงุทุฆุฉ

#### ๐ ุงููุณู 6: ุณููุงุฑูููุงุช ูุนูุฏุฉ
- ุฏูุฌ ุดุงูู ูุฌููุน ูุตุงุฏุฑ ุงูุตูุงุญูุงุช
- ูุฌููุนุงุช ุตูุงุญูุงุช ูุจูุฑุฉ (50+ ุตูุงุญูุฉ)

---

### 4. manageUserPermissions.test.ts

**ุงูุบุฑุถ:** ุงุฎุชุจุงุฑ ุฏุงูุฉ `manageUserPermissions()` ุงูุชู ุชุฏูุฑ ุงุณุชุซูุงุกุงุช ุตูุงุญูุงุช ุงููุณุชุฎุฏููู.

**ุงูููุทู ุงููุนูุฏ:**
1. `is_allowed=true` + ุตูุงุญูุฉ ููุฌูุฏุฉ ูู ุงููุธููุฉ โ **ุญุฐู** ุงูุงุณุชุซูุงุก
2. `is_allowed=true` + ุตูุงุญูุฉ ุบูุฑ ููุฌูุฏุฉ โ **ุฅูุดุงุก/ุชุญุฏูุซ** ุงุณุชุซูุงุก ุจุงูุณูุงุญ
3. `is_allowed=false` + ุตูุงุญูุฉ ููุฌูุฏุฉ โ **ุฅูุดุงุก/ุชุญุฏูุซ** ุงุณุชุซูุงุก ุจุงูุฑูุถ
4. `is_allowed=false` + ุตูุงุญูุฉ ุบูุฑ ููุฌูุฏุฉ โ **ุญุฐู** ุงูุงุณุชุซูุงุก

**ุงูุฃูุณุงู:**

#### ๐ ุงููุณู 1: ุงููุตุงุฏูุฉ
- ุฑูุถ ุงูุทูุจุงุช ุบูุฑ ุงููุตุงุฏู ุนูููุง
- ุชุชุจุน ูู ูุงู ุจุงูุชุบููุฑ (`created_by`)

#### โ ุงููุณู 2: ุงูุญุงูุฉ 1 - ุงูุณูุงุญ ุจุตูุงุญูุฉ ููุฌูุฏุฉ ูู ุงููุธููุฉ
- ุญุฐู ุงูุงุณุชุซูุงุกุงุช ุงูููุฌูุฏุฉ
- ุนุฏู ุฅูุดุงุก ุงุณุชุซูุงุกุงุช ุฌุฏูุฏุฉ

#### โ ุงููุณู 3: ุงูุญุงูุฉ 2 - ุงูุณูุงุญ ุจุตูุงุญูุฉ ุบูุฑ ููุฌูุฏุฉ
- ุฅูุดุงุก ุงุณุชุซูุงุก ุฌุฏูุฏ
- ุชุญุฏูุซ ุงุณุชุซูุงุก ููุฌูุฏ

#### ๐ซ ุงููุณู 4: ุงูุญุงูุฉ 3 - ุฑูุถ ุตูุงุญูุฉ ููุฌูุฏุฉ
- ุฅูุดุงุก ุงุณุชุซูุงุก ุฑูุถ
- ุชุญุฏูุซ ุงุณุชุซูุงุกุงุช ุงูุณูุงุญ ุฅูู ุฑูุถ

#### โ ุงููุณู 5: ุงูุญุงูุฉ 4 - ุฑูุถ ุตูุงุญูุฉ ุบูุฑ ููุฌูุฏุฉ
- ุญุฐู ุงูุงุณุชุซูุงุกุงุช
- ุนุฏู ุฅูุดุงุก ุงุณุชุซูุงุกุงุช ุบูุฑ ุถุฑูุฑูุฉ

#### ๐ฆ ุงููุณู 6: ุงูุนูููุงุช ุงูุฏูุนูุฉ
- ูุนุงูุฌุฉ ุนุฏุฉ ุตูุงุญูุงุช ุฏูุนุฉ ูุงุญุฏุฉ
- ุนูููุงุช ุฅูุดุงุก/ุชุญุฏูุซ/ุญุฐู ูุฎุชูุทุฉ
- ูุตูููุงุช ูุงุฑุบุฉ

#### ๐๏ธ ุงููุณู 7: ูุณุชููุงุช ุงูุตูุงุญูุงุช ุงููุฎุชููุฉ
- ุฎุฏูุงุช ุฑุฆูุณูุฉ
- ุฎุฏูุงุช ูุฑุนูุฉ
- ุฎุฏูุงุช ูุฑุนูุฉ ูู ุงููุณุชูู ุงูุซุงูุซ

#### ๐งช ุงููุณู 8: ุญุงูุงุช ุฎุงุตุฉ
- ูุณุชุฎุฏููู ุจุฏูู `job_id`
- ููู null/undefined
- ูุทุงุจูุฉ ุฏูููุฉ ููููู

---

### 5. manageJobPermissions.test.ts

**ุงูุบุฑุถ:** ุงุฎุชุจุงุฑ ุฏุงูุฉ `manageJobPermissions()` ุงูุชู ุชุฏูุฑ ุตูุงุญูุงุช ุงููุธุงุฆู.

**ุงูุฃูุณุงู:**

#### ๐ ุงููุณู 1: ุงููุตุงุฏูุฉ
- ุฑูุถ ุงูุทูุจุงุช ุบูุฑ ุงููุตุงุฏู ุนูููุง
- ุชุชุจุน ูู ูุงู ุจุงูุชุบููุฑ (`created_by`)

#### โ ุงููุณู 2: ุฅุถุงูุฉ ุงูุตูุงุญูุงุช
- ุฅุถุงูุฉ ุตูุงุญูุงุช ุฎุฏูุงุช ุฑุฆูุณูุฉ (s:X)
- ุฅุถุงูุฉ ุตูุงุญูุงุช ุฎุฏูุงุช ูุฑุนูุฉ (ss:X)
- ุฅุถุงูุฉ ุตูุงุญูุงุช ูุณุชูู ุซุงูุซ (sss:X)
- ุฅุถุงูุฉ ุนุฏุฉ ุตูุงุญูุงุช ุฏูุนุฉ ูุงุญุฏุฉ
- ุนุฏู ุชูุฑุงุฑ ุงูุตูุงุญูุงุช ุงูููุฌูุฏุฉ

#### โ ุงููุณู 3: ุญุฐู ุงูุตูุงุญูุงุช
- ุญุฐู ุตูุงุญูุฉ ูุงุญุฏุฉ
- ุญุฐู ุนุฏุฉ ุตูุงุญูุงุช
- ูุนุงูุฌุฉ ุงูุตูุงุญูุงุช ุบูุฑ ุงูููุฌูุฏุฉ
- ุญุฐู ุตูุงุญูุงุช ูุธููุฉ ูุนููุฉ ููุท

#### ๐ ุงููุณู 4: ุงูุนูููุงุช ุงููุฏูุฌุฉ
- ุฅุถุงูุฉ ูุญุฐู ูู ููุณ ุงูุทูุจ
- ูุนุงูุฌุฉ ููุณ ุงูุตูุงุญูุฉ (ุญุฐู ุซู ุฅุถุงูุฉ)

#### ๐ ุงููุณู 5: ูุนุงูุฌุฉ ุงููุนุฑูุงุช
- ุชุญููู s:X ุจุดูู ุตุญูุญ
- ุชุญููู ss:X ุจุดูู ุตุญูุญ
- ุชุญููู sss:X ุจุดูู ุตุญูุญ
- ุชุฌุงูู ุงููุนุฑูุงุช ุงูุฎุงุทุฆุฉ
- ุฎููุท ูู ุงููุนุฑูุงุช ุงูุตุญูุญุฉ ูุงูุฎุงุทุฆุฉ

#### ๐งช ุงููุณู 6: ุญุงูุงุช ุฎุงุตุฉ
- ูุตูููุงุช ูุงุฑุบุฉ
- `job_id` ุจูููุฉ 0
- `job_id` ูุจูุฑ ุฌุฏุงู
- ุตูุงุญูุงุช ุจูุนุฑู 0
- ุนูููุงุช ุฏูุนูุฉ ูุจูุฑุฉ (100+ ุตูุงุญูุฉ)
- ูุนุฑูุงุช ููุฑุฑุฉ

#### ๐ ุงููุณู 7: ุณููุงุฑูููุงุช ูุนูุฏุฉ
- ุฅุนุงุฏุฉ ููููุฉ ูุงููุฉ ููุตูุงุญูุงุช
- ุงูุญูุงุธ ุนูู ุตูุงุญูุงุช ุงููุธุงุฆู ุงูุฃุฎุฑู

---

## ุงุณุชุฑุงุชูุฌูุฉ ุงูุงุฎุชุจุงุฑ

### 1. ูููุฌูุฉ ุงูุงุฎุชุจุงุฑ

- **Unit Tests**: ุงุฎุชุจุงุฑ ูู ุฏุงูุฉ ุจูุนุฒู ุนู ุงูุฃุฎุฑู
- **Integration Tests**: ุงุฎุชุจุงุฑ ุงูุชูุงุนู ูุน Firestore
- **Edge Case Testing**: ุงุฎุชุจุงุฑ ุงูุญุงูุงุช ุงูุญุฏูุฉ ูุงูุดุงุฐุฉ
- **Error Handling**: ุงุฎุชุจุงุฑ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุจุดูู ุตุญูุญ

### 2. ุชูุธูู ุงูุงุฎุชุจุงุฑุงุช

ูู ููู ุงุฎุชุจุงุฑ ููุธู ุจุงูุทุฑููุฉ ุงูุชุงููุฉ:

```
describe('ุงูุฏุงูุฉ')
  describe('ุงููุณู 1: ุงููุตุงุฏูุฉ')
    it('ุงุฎุชุจุงุฑ 1')
    it('ุงุฎุชุจุงุฑ 2')
  describe('ุงููุณู 2: ุงููุธููุฉ ุงูุฃุณุงุณูุฉ')
    it('ุงุฎุชุจุงุฑ 3')
    it('ุงุฎุชุจุงุฑ 4')
  ...
```

### 3. beforeEach & afterEach

- **beforeEach**: ูุณุญ Firestore ู wrapping ุงูุฏูุงู ูุจู ูู ุงุฎุชุจุงุฑ
- **afterEach**: ุงุณุชุนุงุฏุฉ ุฌููุน ุงูู stubs ุจุนุฏ ูู ุงุฎุชุจุงุฑ

---

## ูุตุงุฆุญ ูุฃูุถู ุงูููุงุฑุณุงุช

### 1. ุนูุฏ ูุชุงุจุฉ ุงุฎุชุจุงุฑ ุฌุฏูุฏ

```typescript
it('should do something specific', async () => {
  // 1. Arrange: ุชุฌููุฒ ุงูุจูุงูุงุช
  await seedFirestore('users', [{ id: 'user-1', data: {...} }]);

  // 2. Act: ุชูููุฐ ุงูุฏุงูุฉ
  const result = await myFunction(request);

  // 3. Assert: ุงูุชุญูู ูู ุงููุชูุฌุฉ
  expect(result).to.deep.equal({ expected: 'value' });
});
```

### 2. ุงุณุชุฎุฏุงู ุงูุจูุงูุงุช ุงูุฌุงูุฒุฉ

```typescript
// ุงุณุชุฎุฏู ุงูุจูุงูุงุช ุงูุฌุงูุฒุฉ ูู setup.ts
await seedFirestore('users', [
  { id: mockUsers.regularUser.uid, data: mockUsers.regularUser.data }
]);
```

### 3. ุงุฎุชุจุงุฑ ุงูุฃุฎุทุงุก

```typescript
try {
  await myFunction(invalidRequest);
  expect.fail('Should have thrown an error');
} catch (error: any) {
  expect(error.code).to.equal('expected-error-code');
}
```

---

## ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ูุดููุฉ: ุงูุงุฎุชุจุงุฑุงุช ุชูุดู ูู ุงูุงุชุตุงู ุจู Firestore

**ุงูุญู:** ุชุฃูุฏ ูู ุชุดุบูู Firestore Emulator:
```bash
firebase emulators:start --only firestore
```

### ูุดููุฉ: ุฃุฎุทุงุก TypeScript

**ุงูุญู:** ุชุฃูุฏ ูู ุงุณุชุฎุฏุงู `tsconfig.test.json`:
```bash
TS_NODE_PROJECT=tsconfig.test.json npm test
```

### ูุดููุฉ: ุจุทุก ุงูุงุฎุชุจุงุฑุงุช

**ุงูุญู:** ูู ุจุชุดุบูู ุงุฎุชุจุงุฑ ูุงุญุฏ ููุท:
```bash
npx mocha --require ts-node/register test/checkPermission.test.ts
```

---

## ุงููุณุงููุฉ

ุนูุฏ ุฅุถุงูุฉ ุฏุงูุฉ ุณุญุงุจูุฉ ุฌุฏูุฏุฉ:

1. ุฃูุดุฆ ููู ุงุฎุชุจุงุฑ ุฌุฏูุฏ ูู `test/`
2. ุงุชุจุน ููุณ ูููู ุงูุงุฎุชุจุงุฑุงุช ุงูููุฌูุฏุฉ
3. ุฃุถู mock data ูู `setup.ts` ุฅุฐุง ูุฒู ุงูุฃูุฑ
4. ุงุญุฑุต ุนูู ุชุบุทูุฉ 80%+ ูู ุงูููุฏ
5. ุฃุถู ุชูุซูู ููุงุฎุชุจุงุฑุงุช ุงูุฌุฏูุฏุฉ ูู ูุฐุง ุงูููู

---

## ุงูุฎูุงุตุฉ

ุชู ุฅูุดุงุก **135+ ุงุฎุชุจุงุฑ** ุดุงูู ูุบุทู ุฌููุน ุฌูุงูุจ ุงูุฏูุงู ุงูุณุญุงุจูุฉ ููุฃุฐููุงุชุ ูุน ุชูุธูู ููุชุงุฒ ูุชูุซูู ูุงุถุญ. ูุฐู ุงูุงุฎุชุจุงุฑุงุช ุชุถูู:

โ ุฃูุงู ูุธุงู ุงูุฃุฐููุงุช
โ ุตุญุฉ ุงูููุทู ุงููุนูุฏ
โ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุจุดูู ุตุญูุญ
โ ุณูููุฉ ุงูุตูุงูุฉ ูุงูุชุทููุฑ

**๐ ุญุธุงู ููููุงู ูู ุงูุงุฎุชุจุงุฑ!**
